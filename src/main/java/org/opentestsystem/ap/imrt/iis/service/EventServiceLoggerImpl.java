package org.opentestsystem.ap.imrt.iis.service;

import org.slf4j.Logger;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;

/**
 * Implementation of EventService that logs the events
 */
@Service
public class EventServiceLoggerImpl extends EventService {
    @Override
    protected void itemEvent(Logger logger, ItemEventType type, Integer key, Integer id, Integer projectId) {
        StringBuilder builder = new StringBuilder();
        List<Object> args = new ArrayList<>(3);
        builder.append("ITEM EVENT type: {}");
        args.add(type);
        if (key != null) {
            builder.append(" key: {}");
            args.add(key);
        }
        if (id != null) {
            builder.append(" id: {}");
            args.add(id);
        }
        if (projectId != null) {
            builder.append(" projectId: {}");
            args.add(projectId);
        }
        logger.info(builder.toString(), args.toArray());
    }

    @Override
    public void serviceEvent(Logger logger, ServiceEventType type, String format, Object... args) {
        String output = type + ": " + format;
        if (ServiceEventType.SERVICE_ERROR == type) {
            logger.error(output, args);
        } else {
            logger.warn(output, args);
        }
    }
}
