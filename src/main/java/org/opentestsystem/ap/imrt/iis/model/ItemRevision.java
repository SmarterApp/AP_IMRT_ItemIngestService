package org.opentestsystem.ap.imrt.iis.model;

import org.opentestsystem.ap.common.imrt.model.Attachment;
import org.opentestsystem.ap.common.imrt.model.BaseItem;
import org.opentestsystem.ap.common.imrt.model.ContentUpdateNeed;
import org.opentestsystem.ap.common.imrt.model.ItemAssignment;
import org.opentestsystem.ap.common.rest.item.ItemEntityResponse;

import java.util.HashSet;
import java.util.Optional;
import java.util.Set;

public class ItemRevision {
    private final BaseItem baseItem;
    private final Integer linkedStimulusId;
    private final boolean existingItem;
    private final Set<ItemAssignment> itemAssignments;
    private final Set<Attachment> attachments;
    private final Set<ContentUpdateNeed> contentUpdateNeeds;
    private final ItemEntityResponse itemEntityResponse;

    private ItemRevision(final BaseItem baseItem,
                         final Integer linkedStimulusId,
                         final boolean existingItem, Set<ItemAssignment> itemAssignments, Set<Attachment> attachments, Set<ContentUpdateNeed> contentUpdateNeeds, final ItemEntityResponse itemEntityResponse) {
        this.baseItem = baseItem;
        this.linkedStimulusId = linkedStimulusId;
        this.existingItem = existingItem;
        this.itemAssignments = itemAssignments;
        this.attachments = attachments;
        this.contentUpdateNeeds = contentUpdateNeeds;

        this.itemEntityResponse = itemEntityResponse;
    }

    public BaseItem getItem() {
        return baseItem;
    }

    public Optional<Integer> getLinkedStimulusId() {
        return Optional.ofNullable(linkedStimulusId);
    }

    public boolean isExistingItem() {
        return existingItem;
    }

    public Set<ItemAssignment> getItemAssignments() {
        return itemAssignments;
    }

    public Set<Attachment> getAttachments() {
        return attachments;
    }

    public Set<ContentUpdateNeed> getContentUpdateNeeds() {
        return contentUpdateNeeds;
    }

    public ItemEntityResponse getItemEntityResponse() {
        return itemEntityResponse;
    }

    public static ItemRevisionModelBuilder builder() {
        return new ItemRevisionModelBuilder();
    }

    public static final class ItemRevisionModelBuilder {
        private BaseItem baseItem;
        private Integer linkedStimulusId;
        private boolean existingItem;
        private Set<ItemAssignment> itemAssignments = new HashSet<>();
        private Set<Attachment> attachments = new HashSet<>();
        private Set<ContentUpdateNeed> contentUpdateNeeds = new HashSet<>();
        private ItemEntityResponse itemEntityResponse;

        private ItemRevisionModelBuilder() {
        }

        public ItemRevisionModelBuilder withBaseItem(BaseItem baseItem) {
            this.baseItem = baseItem;
            return this;
        }

        public ItemRevisionModelBuilder withLinkedStimulusId(Integer linkedStimulusId) {
            this.linkedStimulusId = linkedStimulusId;
            return this;
        }

        public ItemRevisionModelBuilder withExistingItem(boolean existingItem) {
            this.existingItem = existingItem;
            return this;
        }

        public ItemRevisionModelBuilder withItemAssignments(Set<ItemAssignment> itemAssignments) {
            this.itemAssignments = itemAssignments;
            return this;
        }

        public ItemRevisionModelBuilder withAttachments(Set<Attachment> attachments) {
            this.attachments = attachments;
            return this;
        }

        public ItemRevisionModelBuilder withContentUpdateNeeds(Set<ContentUpdateNeed> contentUpdateNeeds) {
            this.contentUpdateNeeds = contentUpdateNeeds;
            return this;
        }

        public ItemRevisionModelBuilder withItemEntityResponse(ItemEntityResponse itemUpdateEvent) {
            this.itemEntityResponse = itemUpdateEvent;
            return this;
        }

        public ItemRevision build() {
            return new ItemRevision(
                    baseItem,
                    linkedStimulusId,
                    existingItem, itemAssignments, attachments, contentUpdateNeeds, itemEntityResponse);
        }
    }
}