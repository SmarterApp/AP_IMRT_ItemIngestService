package org.opentestsystem.ap.imrt.iis.message;

import org.opentestsystem.ap.imrt.common.service.OperationalEventService;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.amqp.core.Message;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

import static org.opentestsystem.ap.imrt.iis.config.MessageQueueConfiguration.ERROR_QUEUE_NAME;

@Component
public class ErrorMessageListener {
    private final Logger LOG = LoggerFactory.getLogger(ErrorMessageListener.class);
    private final OperationalEventService logger;

    public ErrorMessageListener(final OperationalEventService logger) {
        this.logger = logger;
    }

    @RabbitListener(queues = ERROR_QUEUE_NAME)
    public void handleMessage(final Message message) {
        logger.error(LOG, null, "Unable to process message {}", message);
    }
}
