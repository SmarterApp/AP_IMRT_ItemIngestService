package org.opentestsystem.ap.imrt.iis.model;

import org.opentestsystem.ap.imrt.common.model.BaseItem;
import org.opentestsystem.ap.imrt.common.model.ItemGitInformation;
import org.opentestsystem.ap.imrt.common.model.ItemLog;

import java.util.Optional;

public class ItemRevisionModel implements ItemRevision {
    private final ItemGitInformation itemGitInformation;
    private final BaseItem baseItem;
    private final Integer linkedStimulusId;
    private final ItemLog itemLog;
    private final boolean existingItem;

    private ItemRevisionModel(final ItemGitInformation itemGitInformation,
                             final BaseItem baseItem,
                             final Integer linkedStimulusId,
                             final ItemLog itemLog,
                             final boolean existingItem) {
        this.itemGitInformation = itemGitInformation;
        this.baseItem = baseItem;
        this.linkedStimulusId = linkedStimulusId;
        this.itemLog = itemLog;
        this.existingItem = existingItem;
    }

    @Override
    public ItemGitInformation getItemGitInformation() {
        return itemGitInformation;
    }

    @Override
    public BaseItem getItem() {
        return baseItem;
    }

    @Override
    public Optional<Integer> getLinkedStimulusId() {
        return Optional.ofNullable(linkedStimulusId);
    }

    @Override
    public ItemLog getItemLog() {
        return itemLog;
    }

    @Override
    public boolean isExistingItem() {
        return existingItem;
    }

    public static ItemRevisionModelBuilder builder() {
        return new ItemRevisionModelBuilder();
    }

    public static final class ItemRevisionModelBuilder {
        private ItemGitInformation itemGitInformation;
        private BaseItem baseItem;
        private Integer linkedStimulusId;
        private ItemLog itemLog;
        private boolean existingItem;

        private ItemRevisionModelBuilder() {
        }

        public ItemRevisionModelBuilder withItemGitInformation(ItemGitInformation itemGitInformation) {
            this.itemGitInformation = itemGitInformation;
            return this;
        }

        public ItemRevisionModelBuilder withBaseItem(BaseItem baseItem) {
            this.baseItem = baseItem;
            return this;
        }

        public ItemRevisionModelBuilder withLinkedStimulusId(Integer linkedStimulusId) {
            this.linkedStimulusId = linkedStimulusId;
            return this;
        }

        public ItemRevisionModelBuilder withItemLog(ItemLog itemLog) {
            this.itemLog = itemLog;
            return this;
        }

        public ItemRevisionModelBuilder withExistingItem(boolean existingItem) {
            this.existingItem = existingItem;
            return this;
        }

        public ItemRevisionModel build() {
            return new ItemRevisionModel(itemGitInformation,
                    baseItem,
                    linkedStimulusId,
                    itemLog,
                    existingItem);
        }
    }
}